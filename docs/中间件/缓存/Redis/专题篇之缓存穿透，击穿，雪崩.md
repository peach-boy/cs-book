# 专题篇之缓存穿透，缓存击穿，缓存雪崩

## 一、缓存穿透

- 1、什么是缓存穿透

> 正常情况下，当查询一条缓存和数据库都不存在的数据时，每次请求都将打到数据库上。这种查询不存在数据的现象我们称为缓存穿透。

- 2、导致的结果

> 如果黑客不断的利用一个不存在的 id,请求接口，这将对数据库造成很大的压力。

- 3、解决方案

> 1. 布隆过滤器。
> 2. 缓存空值或默认值。

## 二、缓存击穿

- 1、什么是缓存击穿

> 在高并发的系统中，大量的请求同时查询一个热点 key 时，此时这个 key 正好失效了，就会导致大量的请求都打到数据库上面去。这种现象我们称为缓存击穿。

- 2、导致的结果

> DB 压力过大，甚至宕机。

- 3、解决方案

> 对获取热点 key 的请求使用互斥锁，当第一个线程获取到锁，从 DB 请求到数据，会回写到 redis 并释放锁，后面的请求则会直接从缓存中取，从而减轻数据的压力。

## 三、缓存雪崩

- 1、什么是缓存雪崩

> 缓存雪崩的情况是说，当某一时刻发生大规模的缓存失效的情况，比如你的缓存服务宕机了，会有大量的请求进来直接打到 DB 上面。这种现象称为缓存雪崩。

- 2、导致的问题

> DB 压力过大，甚至宕机

- 3、解决方案

> 1. 将过期时间错开，过期时间加小的随机数：如：将过期时间后增加随机数，setRedis(key,value,time+math.random)。
> 2. 高可用集群，以应对大流量。
> 3. 服务做好限流，熔断，降级。作为最后的兜底，防止服务被击垮。
