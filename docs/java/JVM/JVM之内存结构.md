# JVM 之内存模型

## 一、运行时数据区

java 虚拟机在执行 java 程序的过程中，会把它管理的内存划分为若干个不同的数据区，这些区都有各自的用途。
![](../../../pic/java/jvm_1.png)

### 1. 线程隔离(每个线程会有一个私有的栈)

1. 虚拟机栈
   > Java 方法执行的内存模型，每个方法被执行的时候都会创建一个栈帧用于存储局部变量，操作栈，动态链接，方法入口等信息，每个方法被调用直至被执行完成的过程，就对应一个栈帧的入栈和出栈的过程。
   - 栈溢出异常(StackOverflowError):如果线程请求的栈深度大于栈所允许的深度，将抛出栈溢出异常。
   - 内存溢出(OutOfMemeryError)：当扩展是无法申请到足够多的内存时会抛出异常
2. 本地方法栈
   > 给本地方法调用使用的栈内存
3. 程序计数器
   > 当前线程所执行的字节码的行号指示器。由于 Java 虚拟机的多线程是通过线程的轮流切换并分配处理器执行时间来实现的，一个处理器在一个时刻只会执行一条线程指令，因此为了线程切换后你能恢复到正确的执行位置，每个线程需要独立的程序计数器。

### 2. 线程共享

1. 堆
   > 所有的对象实例及数组都要在堆上分配内存
   - 内存溢出（OutOfMemeryError）：堆中没有内存可以完成实例分配，并且堆也无法在扩展，将会抛出 outOfMemoryerror
2. 方法区
   > 存储已被虚拟机加载的类信息，常量，静态变量，即时编译器编译后的代码等数据
   - 运行时常量池：方法区的一部分

## 二、对象访问

## 三、内存溢出
